# patient-acct-spec.yaml

openapi: 3.0.0
info:
  title: Patient-Account # 0
  description: Patient Account API specification is an outline of all functionality that allows a user to maintain an account. 
  version: 0.1.0
servers:
# the dash '-' indicates an array
  - url: http://localhost:8080/v1 # 1
    description: Developer Server
  - url: http://localhost/v1
    description: Production Server
tags:
# set the grouping of operations
  - name: patients
    description: Patient Account

paths:
  /patients:
    get: # 2
      summary: Retrieve all patients
      tags: # put this operation into the patients tag grouping
        - patients
      security:
        - BearerAuth
      description: Returns a JSON object of all patient records

      responses: # 3
        '200':    # status code
        # This one is repeated: define a 'component' schema
        # using a reference `$ref` 
          # description: Ok
          # content:
          #   application/json:
          #     schema: 
          #       type: array
          #       items: 
          #         type: string
          $ref: '#/components/responses/SuccessGetAll'
          # Not create this. 
        '401':
          $ref: '#/components/responses/Unauthorized'


# Components
components:
  schemas:
    body_response_error:
      required:
        - code_error
        - message
      type:
        object
      properties:
        code_error:
          type: integer
          format: int64
          example: 123
        message:
          type: string
          example: message_to_show_from_server
    patient:
      required:    
        - id  
        - firstName
        - lastName 
        - dateBirth               
        - gender
        - phoneNumber
        - user
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        firstName:
          type: string
          minLength: 3
          example: 'James'
        lastName:
          type: string
          minLength: 3
          example: 'Hemings'
        dob:
          type: string
          format: date
          example: 01/01/1765
        gender:
          type: string
          example: M
          enum:
            - M
            - F
        phoneNumber:
          type: number
          forat: int32
          example: 555-123-4567
        user:
          $ref: '#/components/schemas/user'
        # end 'patient'
      # being 'user'
    user:
      required:
        - id
        - email
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        email:
          type: string
          format: email
          minLengh: 10
          example: 'james.hemings@piecemeal.io'

  responses:
    SuccessGetAll:
      description: Ok # same as "status message in spec"
      content:
        application/json:
          schema:
            # this refers to patient schema
            $ref: '#/components/schemas/patient'
    Unauthorized:
      description: Unuathorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/body_response_error'
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
